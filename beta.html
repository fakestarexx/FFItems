<!DOCTYPE html>
<html data-n-head-ssr lang="en" data-lang="en" data-n-head="enc:3f9c1ae7b92d4f108af21dbe7c12f9aa">
<head data-n-head>
<title>FFItems - Free Fire Items</title><meta data-n-head charset="UTF-8"/><meta data-n-head http-equiv="Content-Type" content="text/html; charset=utf-8"/><meta data-n-head name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/><meta data-n-head name="description" content="Search Free Fire game items by name or description to retrieve item ID, name & details."/><meta data-n-head name="keywords" content="Free Fire items, Free Fire ID, gun skins, emotes, bundles, Starexx FF, FFItems, ItemID2, FF ItemID"/><meta data-n-head name="author" content="Starexx"/><meta data-n-head name="robots" content="index, follow"/><link data-n-head rel="canonical" href="https://realstatexx.github.io/FFItems/"/><meta data-n-head property="og:title" content="FFItems - Items Database"/><meta data-n-head property="og:description" content="Search Free Fire items quickly witg names & details."/><meta data-n-head property="og:image" content="https://realstatexx.github.io/FFItems/icons/android-chrome-192x192.png"/><meta data-n-head property="og:type" content="website"/><meta data-n-head property="og:url" content="https://realstatexx.github.io/FFItems/"/><meta data-n-head name="twitter:card" content="summary_large_image"/><meta data-n-head name="twitter:title" content="FFItems"/><meta data-n-head name="twitter:description" content="Quickly find Free Fire item IDs, names & details."/><meta data-n-head name="twitter:image" content="https://realstatexx.github.io/FFItems/icons/android-chrome-192x192.png"/><meta data-n-head name="google-site-verification" content="joLKEyzfZROYT_Ck4mea3yx94rNwOqRwqalvV-xcA8U"/><link data-n-head rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png"/><link data-n-head rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png"/><link data-n-head rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png"/><link data-n-head rel="manifest" href="manifest.json"/><link data-n-head rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/><link data-n-head href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet"/><link data-n-head href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@100;200;300;400;500;600;700&display=swap" rel="stylesheet"/>
</head>
<style>
:root {
  --bg-primary: #000000;
  --bg-secondary: #111111;
  --bg-tertiary: #121212;
  --bg-card: transparent;
  --border-primary: #222222;
  --border-secondary: #333333;
  --text-primary: #ffffff;
  --text-secondary: #cccccc;
  --text-muted: #888888;
  --accent-primary: #ffffff;
  --accent-secondary: #333;
  --hover-primary: #181818;
  --modal-bg: #111111;
  --modal-border: #222222;
  --header-height: 60px;
  --pill-radius: 20px;
  --modal-radius: 20px;
  --box-radius: 20px;
  --transition-fast: 0.15s ease;
  --transition-medium: 0.2s ease;
  --transition-slow: 0.3s ease;
  --transition-modal: 0.4s cubic-bezier(.4,0,.2,1);
  --transition-flip: 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  --shadow-modal: 0 10px 30px rgba(0,0,0,0.5);
  --blur-backdrop: blur(4px);
  --font-main: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  --font-mono: 'IBM Plex Mono', monospace;
  --font-size-sm: 6px;
  --font-size-md: 12px;
  --font-size-lg: 14px;
  --font-size-xl: 16px;
  --spacing-xs: 12px;
  --spacing-sm: 8px;
  --spacing-md: 8px;
  --spacing-lg: 15px;
  --spacing-xl: 20px;
  --spacing-xxl: 25px;
  --icon-size: 70%;
  --modal-icon-size: 80%;
  --grid-cols: 5;
  --items-per-page: 100;
  --max-width: 800px;
}
@media (min-width: 1024px) {
  :root {
    --grid-cols: 10;
    --max-width: 1200px;
    --icon-size: 80%;
  }
}
.ibm-plex-mono-thin {
  font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
  font-weight: 100;
  font-style: normal;
}
.ibm-plex-mono-extralight {
  font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
  font-weight: 200;
  font-style: normal;
}
.ibm-plex-mono-light {
  font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
  font-weight: 300;
  font-style: normal;
}
.ibm-plex-mono-regular {
  font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
  font-weight: 400;
  font-style: normal;
}
.ibm-plex-mono-medium {
  font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
  font-weight: 500;
  font-style: normal;
}
.ibm-plex-mono-semibold {
  font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
  font-weight: 600;
  font-style: normal;
}
.ibm-plex-mono-bold {
  font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
  font-weight: 700;
  font-style: normal;
}
.ibm-plex-mono-thin-italic {
  font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
  font-weight: 100;
  font-style: italic;
}
.ibm-plex-mono-extralight-italic {
  font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
  font-weight: 200;
  font-style: italic;
}
.ibm-plex-mono-light-italic {
  font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
  font-weight: 300;
  font-style: italic;
}
.ibm-plex-mono-regular-italic {
  font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
  font-weight: 400;
  font-style: italic;
}
.ibm-plex-mono-medium-italic {
  font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
  font-weight: 500;
  font-style: italic;
}
.ibm-plex-mono-semibold-italic {
  font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
  font-weight: 600;
  font-style: italic;
}
.ibm-plex-mono-bold-italic {
  font-family: "IBM Plex Mono", Noto Sans Mono Variable, Noto Sans Mono, monospace;
  font-weight: 700;
  font-style: italic;
}
* {
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
}
::selection {
  background: rgba(255, 255, 255, 0.1);
  color: white;
}
body {
  margin: 0;
  font-family: var(--font-main);
  background: var(--bg-primary);
  color: var(--text-primary);
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
  overflow-x: hidden;
  user-select: none;
}
::-webkit-scrollbar {
  display: none;
}
body, .header {
  -ms-overflow-style: none;
  scrollbar-width: none;
}
.header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  display: flex;
  justify-content: left;
  align-items: center;
  background: var(--bg-primary);
  padding: var(--spacing-md) var(--spacing-xl);
  z-index: 51;
  height: var(--header-height);
  gap: var(--spacing-md);
  flex-wrap: nowrap;
  overflow-x: auto;
  white-space: nowrap;
  max-width: 100%;
}
.main-content {
  margin-top: 50px;
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
}
.footer {
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  background: var(--bg-primary);
  padding: var(--spacing-md) var(--spacing-xl);
  border: none;
  margin-top: auto;
  margin-bottom: 20px;
  gap: var(--spacing-md);
}
.grid {
  display: grid;
  grid-template-columns: repeat(var(--grid-cols), 1fr);
  gap: var(--spacing-md);
  width: 90%;
  max-width: var(--max-width);
  margin-bottom: var(--spacing-xl);
}
.pages-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
  gap: var(--spacing-md);
}
.filter-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--spacing-md);
  margin-top: var(--spacing-lg);
}
.box {
  background: var(--bg-tertiary);
  border-radius: var(--box-radius);
  aspect-ratio: 1 / 1;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  transition: transform var(--transition-fast), background var(--transition-medium);
  user-select: none;
  border: 1px solid var(--border-primary);
  overflow: hidden;
}
.icon {
  width: var(--icon-size);
  height: var(--icon-size);
  object-fit: contain;
  opacity: 0;
  transition: opacity 0.3s ease;
  image-rendering: -webkit-optimize-contrast;
  image-rendering: crisp-edges;
}
.icon.loaded {
  opacity: 1;
}
.header-pill {
  background: var(--bg-tertiary);
  color: var(--text-primary);
  border: none;
  border-radius: var(--pill-radius);
  padding: var(--spacing-sm) var(--spacing-lg);
  cursor: pointer;
  transition: background var(--transition-medium), transform var(--transition-fast);
  font-size: var(--font-size-lg);
  font-weight: 500;
  font-family: var(--font-main);
  white-space: nowrap;
}
.footer-pill {
  background: var(--bg-tertiary);
  color: var(--text-primary);
  border: none;
  border-radius: var(--pill-radius);
  padding: var(--spacing-sm) var(--spacing-lg);
  font-size: var(--font-size-lg);
  font-weight: 500;
  font-family: var(--font-main);
  cursor: pointer;
  transition: transform var(--transition-fast);
}
.mode-tab {
  background: var(--bg-tertiary);
  color: var(--text-primary);
  border: none;
  border-radius: var(--pill-radius);
  padding: var(--spacing-sm) var(--spacing-lg);
  font-size: var(--font-size-lg);
  font-weight: 500;
  font-family: var(--font-main);
  cursor: pointer;
  transition: background var(--transition-medium), transform var(--transition-fast);
}
.sheet-page-btn {
  background: transparent;
  color: var(--text-primary);
  border: none;
  border-radius: 30px;
  padding: var(--spacing-md);
  cursor: pointer;
  transition: background var(--transition-medium);
  text-align: center;
  font-size: var(--font-size-lg);
  font-family: var(--font-main);
}
.filter-btn {
  background: transparent;
  color: var(--text-primary);
  border: none;
  border-radius: 20px;
  padding: var(--spacing-md);
  cursor: pointer;
  transition: transform var(--transition-medium), background var(--transition-medium);
  text-align: center;
  font-size: var(--font-size-md);
  font-family: var(--font-main);
  min-height: 45px;
  width: 100%;
}
.modal {
  position: fixed;
  border-radius: var(--modal-radius);
  background: var(--modal-bg);
  color: var(--text-primary);
  z-index: 100;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: all var(--transition-modal);
  overflow: hidden;
  box-shadow: var(--shadow-modal);
  border: 1px solid var(--modal-border);
}
.modal-icon {
  width: var(--modal-icon-size);
  height: var(--modal-icon-size);
  object-fit: contain;
  cursor: pointer;
  transition: background var(--transition-medium), transform var(--transition-fast);
  opacity: 0;
  image-rendering: -webkit-optimize-contrast;
  image-rendering: crisp-edges;
}
.fade-bg {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.4);
  backdrop-filter: var(--blur-backdrop);
  opacity: 0;
  transition: opacity var(--transition-slow);
  z-index: 52;
  pointer-events: none;
}
.bottom-sheet {
  position: fixed;
  bottom: 20px;
  left: 20px;
  right: 20px;
  background: var(--modal-bg);
  border-radius: 30px;
  padding: var(--spacing-lg) var(--spacing-xl) var(--spacing-xxl) var(--spacing-xl);
  z-index: 150;
  transform: translateY(150%);
  transition: transform var(--transition-slow);
  max-height: 70vh;
  overflow-y: auto;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
}
.modal-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 100;
  pointer-events: none;
}
.details-card {
  position: fixed;
  background: var(--modal-bg);
  border-radius: var(--modal-radius);
  box-shadow: var(--shadow-modal);
  border: 1px solid var(--modal-border);
  padding: 15px;
  z-index: 101;
  display: flex;
  flex-direction: column;
  height: auto;
  overflow-y: auto;
  transform: translateY(30px);
  opacity: 0;
  transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  max-width: 90vw;
  box-sizing: border-box;
  left: 50%;
  transform: translateX(-50%) translateY(30px);
  user-select: text !important;
  pointer-events: auto !important;
}
.search-textarea {
  width: 100%;
  min-height: 20px;
  max-height: 32px;
  padding: var(--spacing-sm) var(--spacing-lg);
  border-radius: 20px;
  border: none;
  background: var(--bg-tertiary);
  color: var(--text-primary);
  font-family: inherit;
  outline: none;
  font-size: var(--font-size-md);
  font-weight: 500;
  resize: none;
  overflow-y: auto;
  font-family: var(--font-main);
  white-space: nowrap;
}
.search-textarea::placeholder {
  color: var(--text-muted);
}
.search-hint {
  font-size: var(--font-size-md);
  color: var(--text-muted);
  text-align: center;
  margin-top: var(--spacing-md);
  font-family: var(--font-main);
}
.no-results {
  grid-column: 1 / -1;
  text-align: center;
  padding: var(--spacing-xl);
  color: var(--text-muted);
  font-family: var(--font-main);
}
.loading {
  grid-column: 1 / -1;
  text-align: center;
  padding: var(--spacing-xl);
  color: var(--text-muted);
  font-family: var(--font-main);
}
.search-results-text {
  font-size: var(--font-size-md);
  color: #666;
  text-align: center;
  margin: var(--spacing-md) 0;
  font-family: var(--font-main);
}
.details-title {
  font-size: 15px;
  font-weight: 600;
  margin-bottom: 12px;
  color: var(--text-primary);
  font-family: "IBM Plex Mono", monospace;
  line-height: 1.3;
  word-wrap: break-word;
}
.details-properties {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.details-property {
  display: block;
  line-height: 1.4;
  font-size: 12px;
}
.details-property-label {
  font-weight: 700;
  color: var(--text-primary);
}
.details-property-value {
  font-weight: 400;
  color: var(--text-secondary);
}
.sheet-page-btn.active {
  background: var(--accent-primary);
  color: var(--bg-primary);
}
.filter-btn.active {
  background: white;
  color: black;
}
.fade-bg.active {
  opacity: 1;
  pointer-events: all;
}
.bottom-sheet.active {
  transform: translateY(0);
}
.modal-container.active {
  pointer-events: all;
}
.details-card.active {
  transform: translateX(-50%) translateY(0);
  opacity: 1;
}
.modal-icon.loaded {
  opacity: 1;
}
.header-pill:hover {
  background: var(--hover-primary);
}
.header-pill:active {
  transform: scale(0.9);
}
.mode-tab:active {
  transform: scale(0.9);
}
.box:active {
  transform: scale(0.9);
  background: var(--hover-primary);
}
.footer-pill:active {
  transform: scale(0.9);
}
.filter-btn:active {
  transform: scale(0.9);
}
.modal-icon:active {
  transform: scale(0.9);
}
.sheet-page-btn:hover {
  background: var(--hover-primary);
}
</style>
  <body>
    <div class="header">
      <textarea class="search-textarea" id="searchTextarea" placeholder="Search"></textarea>
      <div class="header-pill type-filter" id="typePill">Type</div>
      <div class="header-pill rarity-filter" id="rarityPill">Rarity</div>
    </div>

    <div class="main-content">
      <div id="searchResults" class="search-results-text"></div>
      <div class="grid" id="grid">
        <div class="loading"></div>
      </div>
      <div class="footer">
        <button class="mode-tab active" id="modeTab">Items</button>
        <div class="footer-pill" id="pagePill">Created by Starexx</div>
      </div>
    </div>

    <div class="fade-bg" id="fadeBg"></div>

    <div class="bottom-sheet" id="pageSheet">
      <div class="pages-grid" id="pagesGrid"></div>
    </div>

    <div class="bottom-sheet search-sheet" id="searchSheet">
      <div class="search-hint">Search is now available in the header</div>
    </div>

    <div class="bottom-sheet" id="typeSheet">
      <div class="filter-grid" id="typeGrid"></div>
    </div>

    <div class="bottom-sheet" id="raritySheet">
      <div class="filter-grid" id="rarityGrid"></div>
    </div>

    <script>
const Logic = (function() {
    let state = {
        grid: null,
        fadeBg: null,
        pagePill: null,
        footerPill: null,
        typePill: null,
        rarityPill: null,
        pageSheet: null,
        searchSheet: null,
        typeSheet: null,
        raritySheet: null,
        searchTextarea: null,
        pagesGrid: null,
        typeGrid: null,
        rarityGrid: null,
        searchResults: null,
        modeTab: null,
        
        activeClone: null,
        originalBox: null,
        detailsCard: null,
        modalContainer: null,
        currentPage: 1,
        itemsPerPage: 100,
        allItems: [],
        allIcons: [],
        filteredItems: [],
        filteredIcons: [],
        totalPages: 1,
        currentSearchQuery: "",
        currentMode: "items",
        currentType: "",
        currentRarity: "",
        allTypes: [],
        allRarities: [],
        imageCache: new Map(),
        failedImages: new Set(),
        isModalAnimating: false,
        
        rarityMap: {
            "WHITE": "Common",
            "BLUE": "Rare",
            "GREEN": "Uncommon",
            "ORANGE": "Mythic",
            "ORANGE_PLUS": "Mythic+",
            "PURPLE": "Epic",
            "PURPLE_PLUS": "Epic+",
            "RED": "Artifact"
        }
    };

    function init() {
        setupElements();
        setupEventDelegation();
        parseURLParameters();
        fetchData();
    }

    function setupElements() {
        state.grid = document.getElementById('grid');
        state.fadeBg = document.getElementById('fadeBg');
        state.pagePill = document.getElementById('pagePill');
        state.typePill = document.getElementById('typePill');
        state.rarityPill = document.getElementById('rarityPill');
        state.pageSheet = document.getElementById('pageSheet');
        state.searchSheet = document.getElementById('searchSheet');
        state.typeSheet = document.getElementById('typeSheet');
        state.raritySheet = document.getElementById('raritySheet');
        state.searchTextarea = document.getElementById('searchTextarea');
        state.pagesGrid = document.getElementById('pagesGrid');
        state.typeGrid = document.getElementById('typeGrid');
        state.rarityGrid = document.getElementById('rarityGrid');
        state.searchResults = document.getElementById('searchResults');
        state.modeTab = document.getElementById('modeTab');
    }

    function setupEventDelegation() {
        document.addEventListener('click', handleDocumentClick);
        document.addEventListener('touchmove', handleTouchMove, { passive: false });
        
        state.searchTextarea.addEventListener('input', handleSearchInput);
        state.searchTextarea.addEventListener('keydown', handleSearchKeydown);
        
        state.fadeBg.addEventListener('click', handleFadeBgClick);
        
        state.modeTab.addEventListener('click', handleModeTabClick);
    }

    function parseURLParameters() {
        const urlParams = new URLSearchParams(window.location.search);
        
        const modeParam = urlParams.get('mode');
        if (modeParam && (modeParam === 'items' || modeParam === 'icons')) {
            state.currentMode = modeParam;
            state.modeTab.textContent = modeParam === 'items' ? 'Items' : 'Icons';
            state.modeTab.classList.toggle('active', true);
        }
        
        const typeParam = urlParams.get('type');
        if (typeParam) {
            state.currentType = typeParam;
        }
        
        const rarityParam = urlParams.get('rare');
        if (rarityParam) {
            state.currentRarity = rarityParam;
        }
        
        const searchParam = urlParams.get('q');
        if (searchParam) {
            state.currentSearchQuery = searchParam;
            state.searchTextarea.value = searchParam;
        }
    }

    function updateURLParameters() {
        const urlParams = new URLSearchParams();
        
        urlParams.set('mode', state.currentMode);
        
        if (state.currentType) {
            urlParams.set('type', state.currentType);
        }
        
        if (state.currentRarity) {
            urlParams.set('rare', state.currentRarity);
        }
        
        if (state.currentSearchQuery) {
            urlParams.set('q', state.currentSearchQuery);
        }
        
        const newUrl = urlParams.toString() ? `${window.location.pathname}?${urlParams.toString()}` : window.location.pathname;
        window.history.replaceState({}, '', newUrl);
    }

    function handleDocumentClick(e) {
        const target = e.target;
        
        if (target.classList.contains('header-pill')) {
            handleHeaderPillClick(target);
        } else if (target.classList.contains('footer-pill')) {
            handleFooterPillClick(target);
        } else if (target.classList.contains('sheet-page-btn')) {
            handlePageButtonClick(target);
        } else if (target.classList.contains('filter-btn')) {
            handleFilterButtonClick(target);
        } else if (target.classList.contains('box') || target.closest('.box')) {
            const box = target.classList.contains('box') ? target : target.closest('.box');
            handleBoxClick(box);
        }
    }

    function handleTouchMove(e) {
        if (state.activeClone) {
            e.preventDefault();
        }
    }

    function handleSearchInput(e) {
        state.currentPage = 1;
        state.currentSearchQuery = e.target.value.trim();
        renderGrid();
        updateHeaderPills();
        updateURLParameters();
    }

    function handleSearchKeydown(e) {
        if (e.key === 'Enter') {
            e.preventDefault();
            closeAllSheets();
        }
    }

    function handleFadeBgClick(e) {
        if (e.target === state.fadeBg && !state.isModalAnimating) {
            closeModal();
            closeAllSheets();
        }
    }

    function handleModeTabClick() {
        state.currentMode = state.currentMode === 'items' ? 'icons' : 'items';
        state.currentPage = 1;
        
        state.modeTab.textContent = state.currentMode === 'items' ? 'Items' : 'Icons';
        state.modeTab.classList.add('active');
        
        state.searchTextarea.placeholder = state.currentMode === 'items' 
            ? 'Search' 
            : 'Search';
        
        renderGrid();
        updateURLParameters();
    }

    function handleHeaderPillClick(target) {
        if (target === state.typePill) {
            openTypeSheet();
        } else if (target === state.rarityPill) {
            openRaritySheet();
        }
    }

    function handleFooterPillClick(target) {
        if (target === state.pagePill) {
            openPageSheet();
        }
    }

    function handlePageButtonClick(target) {
        const page = parseInt(target.textContent);
        state.currentPage = page;
        renderGrid();
        closeAllSheets();
    }

    function handleFilterButtonClick(target) {
        const parent = target.parentElement;
        
        if (parent.id === 'typeGrid') {
            if (target.textContent === 'All Types') {
                state.currentType = "";
            } else {
                state.currentType = target.textContent;
            }
        } else if (parent.id === 'rarityGrid') {
            if (target.textContent === 'All Rarities') {
                state.currentRarity = "";
            } else {
                const rarityKey = Object.keys(state.rarityMap).find(key => 
                    state.rarityMap[key] === target.textContent
                ) || target.textContent;
                state.currentRarity = rarityKey;
            }
        }
        
        state.currentPage = 1;
        renderGrid();
        closeAllSheets();
        updateURLParameters();
    }

    function handleBoxClick(box) {
        if (state.currentMode === 'items') {
            const index = Array.from(state.grid.children).indexOf(box);
            const startIndex = (state.currentPage - 1) * state.itemsPerPage;
            const actualIndex = startIndex + index;
            
            if (actualIndex >= 0 && actualIndex < state.filteredItems.length) {
                const item = state.filteredItems[actualIndex];
                openModal(box, item);
            }
        } else {
            const index = Array.from(state.grid.children).indexOf(box);
            const startIndex = (state.currentPage - 1) * state.itemsPerPage;
            const actualIndex = startIndex + index;
            
            if (actualIndex >= 0 && actualIndex < state.filteredIcons.length) {
                const iconName = state.filteredIcons[actualIndex];
                const item = {
                    icon: iconName,
                    name: extractIconName(iconName)
                };
                openModal(box, item);
            }
        }
    }

    function fetchData() {
        Promise.all([
            fetch('assets/itemData.json').then(r => r.ok ? r.json() : Promise.reject()),
            fetch('assets/assets.json').then(r => r.ok ? r.json() : Promise.reject())
        ])
        .then(([itemsData, iconsData]) => {
            state.allItems = itemsData;
            state.allIcons = Array.isArray(iconsData) ? iconsData : Object.values(iconsData).filter(item => typeof item === 'string');
            
            processData();
            renderGrid();
        })
        .catch(error => {
            state.grid.innerHTML = '<div class="no-results">Failed to load data. Please check if JSON files exist.</div>';
        });
    }

    function processData() {
        state.allTypes = [...new Set(state.allItems.map(item => item.type).filter(Boolean))].sort();
        state.allRarities = [...new Set(state.allItems.map(item => item.Rare).filter(Boolean))]
            .filter(rarity => rarity !== "255" && rarity !== "NONE")
            .sort();
        
        state.filteredItems = [...state.allItems];
        state.filteredIcons = [...state.allIcons];
        state.totalPages = Math.ceil(state.filteredItems.length / state.itemsPerPage);
    }

    function getImageUrl(iconName) {
        if (!iconName) return 'https://cdn.jsdelivr.net/gh/9112000/FFItems@master/assets/images/error-404.png';
        if (iconName.includes('https://')) return iconName;
        return `https://raw.githubusercontent.com/0xme/ff-resources/refs/heads/main/pngs/300x300/${iconName}.png`;
    }

    function createImageElement(iconName, className, altText) {
    const icon = document.createElement('img');
    icon.className = className;
    icon.alt = altText || 'Free Fire Item';
    
    const imageUrl = getImageUrl(iconName);
    
    if (state.failedImages.has(imageUrl)) {
        icon.src = `https://freefiremobile-a.akamaihd.net/common/Local/PK/FF_UI_Icon/${iconName}.png`;
        icon.classList.add('loaded');
        return icon;
    }
    
    if (state.imageCache.has(imageUrl)) {
        icon.src = state.imageCache.get(imageUrl);
        icon.classList.add('loaded');
    } else {
        const githubUrl = `https://raw.githubusercontent.com/0xme/ff-resources/refs/heads/main/pngs/300x300/${iconName}.png`;
        const freefireUrl = `https://freefiremobile-a.akamaihd.net/common/Local/PK/FF_UI_Icon/${iconName}.png`;
        const errorUrl = 'https://cdn.jsdelivr.net/gh/9112000/FFItems@5e8cc4727d5e19ed975aed50497167bf9228fea4/assets/images/error-404.png';
        
        icon.src = githubUrl;
        
        const imgLoader = new Image();
        
        imgLoader.onload = () => {
            icon.src = githubUrl;
            icon.classList.add('loaded');
            state.imageCache.set(imageUrl, githubUrl);
        };
        
        imgLoader.onerror = () => {
            state.failedImages.add(githubUrl);
            
            const fallbackLoader = new Image();
            
            fallbackLoader.onload = () => {
                icon.src = freefireUrl;
                icon.classList.add('loaded');
                state.imageCache.set(imageUrl, freefireUrl);
            };
            
            fallbackLoader.onerror = () => {
                icon.src = errorUrl;
                icon.classList.add('loaded');
                state.imageCache.set(imageUrl, errorUrl);
            };
            
            fallbackLoader.src = freefireUrl;
        };
        
        imgLoader.src = githubUrl;
    }
    
    return icon;
    }

    function renderGrid() {
        state.grid.innerHTML = "";
        
        if (state.currentMode === "items") {
            state.filteredItems = state.allItems.filter(item => {
                const matchesSearch = !state.currentSearchQuery || 
                    (item.name && item.name.toLowerCase().includes(state.currentSearchQuery.toLowerCase())) ||
                    (item.itemID && item.itemID.toString().includes(state.currentSearchQuery)) ||
                    (item.icon && item.icon.toLowerCase().includes(state.currentSearchQuery.toLowerCase())) ||
                    (item.description && item.description.toLowerCase().includes(state.currentSearchQuery.toLowerCase()));
                
                const matchesType = !state.currentType || item.type === state.currentType;
                const matchesRarity = !state.currentRarity || item.Rare === state.currentRarity;
                
                return matchesSearch && matchesType && matchesRarity;
            });
            
            state.totalPages = Math.ceil(state.filteredItems.length / state.itemsPerPage);
            
            if (state.filteredItems.length === 0) {
                state.grid.innerHTML = '<div class="no-results">No items found matching your filters</div>';
                updateHeaderPills();
                updateSearchResultsText();
                return;
            }
            
            const startIndex = (state.currentPage - 1) * state.itemsPerPage;
            const endIndex = Math.min(startIndex + state.itemsPerPage, state.filteredItems.length);
            const itemsToShow = state.filteredItems.slice(startIndex, endIndex);
            
            itemsToShow.forEach(item => {
                const box = document.createElement('div');
                box.className = 'box';
                
                const icon = createImageElement(item.icon, 'icon', item.name || 'Starexx');
                box.appendChild(icon);
                state.grid.appendChild(box);
            });
        } else {
            if (state.currentSearchQuery) {
                state.filteredIcons = state.allIcons.filter(iconName => 
                    iconName && iconName.toLowerCase().includes(state.currentSearchQuery.toLowerCase())
                );
            } else {
                state.filteredIcons = [...state.allIcons];
            }
            
            state.totalPages = Math.ceil(state.filteredIcons.length / state.itemsPerPage);
            
            if (state.filteredIcons.length === 0) {
                state.grid.innerHTML = '<div class="no-results">No icons found matching your search</div>';
                updateHeaderPills();
                updateSearchResultsText();
                return;
            }
            
            const startIndex = (state.currentPage - 1) * state.itemsPerPage;
            const endIndex = Math.min(startIndex + state.itemsPerPage, state.filteredIcons.length);
            const iconsToShow = state.filteredIcons.slice(startIndex, endIndex);
            
            iconsToShow.forEach(iconName => {
                const box = document.createElement('div');
                box.className = 'box';
                
                const icon = createImageElement(iconName, 'icon', iconName);
                box.appendChild(icon);
                state.grid.appendChild(box);
            });
        }
        
        updateHeaderPills();
        updateSearchResultsText();
    }

    function extractIconName(iconString) {
        if (!iconString) return "Unknown Icon";
        if (iconString.includes('https://')) {
            const url = new URL(iconString);
            const pathSegments = url.pathname.split('/');
            const fileName = pathSegments[pathSegments.length - 1];
            return fileName.replace('.png', '');
        }
        return iconString;
    }

    function updateHeaderPills() {
        state.pagePill.textContent = `Page ${state.currentPage}/${state.totalPages}`;
        
        if (state.currentMode === "items") {
            document.querySelectorAll('.type-filter, .rarity-filter').forEach(el => {
                el.style.display = 'block';
            });
            
            if (state.currentType) {
                state.typePill.textContent = state.currentType;
                state.typePill.classList.add('active');
            } else {
                state.typePill.textContent = "Type";
                state.typePill.classList.remove('active');
            }
            
            if (state.currentRarity) {
                let displayRarity = state.currentRarity;
                if (state.rarityMap[state.currentRarity]) {
                    displayRarity = state.rarityMap[state.currentRarity];
                }
                state.rarityPill.textContent = displayRarity;
                state.rarityPill.classList.add('active');
            } else {
                state.rarityPill.textContent = "Rarity";
                state.rarityPill.classList.remove('active');
            }
        } else {
            document.querySelectorAll('.type-filter, .rarity-filter').forEach(el => {
                el.style.display = 'none';
            });
        }
    }

    function updateSearchResultsText() {
        if (state.currentSearchQuery || state.currentType || state.currentRarity) {
            const itemCount = state.currentMode === "items" ? state.filteredItems.length : state.filteredIcons.length;
            let filterText = [];
            
            if (state.currentSearchQuery) filterText.push(`"${state.currentSearchQuery}"`);
            if (state.currentType) filterText.push(`Type: ${state.currentType}`);
            if (state.currentRarity) {
                let displayRarity = state.currentRarity;
                if (state.rarityMap[state.currentRarity]) {
                    displayRarity = state.rarityMap[state.currentRarity];
                }
                filterText.push(`Rarity: ${displayRarity}`);
            }
            
        } else {
            state.searchResults.textContent = "";
        }
    }

    function openTypeSheet() {
        state.typeGrid.innerHTML = "";
        
        const allBtn = document.createElement('button');
        allBtn.className = `filter-btn ${!state.currentType ? 'active' : ''}`;
        allBtn.textContent = 'All Types';
        state.typeGrid.appendChild(allBtn);
        
        state.allTypes.forEach(type => {
            const btn = document.createElement('button');
            btn.className = `filter-btn ${state.currentType === type ? 'active' : ''}`;
            btn.textContent = type;
            state.typeGrid.appendChild(btn);
        });
        
        openSheet(state.typeSheet);
    }

    function openRaritySheet() {
        state.rarityGrid.innerHTML = "";
        
        const allBtn = document.createElement('button');
        allBtn.className = `filter-btn ${!state.currentRarity ? 'active' : ''}`;
        allBtn.textContent = 'All Rarities';
        state.rarityGrid.appendChild(allBtn);
        
        state.allRarities.forEach(rarity => {
            const btn = document.createElement('button');
            btn.className = `filter-btn ${state.currentRarity === rarity ? 'active' : ''}`;
            
            let displayName = rarity;
            if (state.rarityMap[rarity]) {
                displayName = state.rarityMap[rarity];
            }
            
            btn.textContent = displayName;
            state.rarityGrid.appendChild(btn);
        });
        
        openSheet(state.raritySheet);
    }

    function openPageSheet() {
        state.pagesGrid.innerHTML = "";
        
        for (let i = 1; i <= state.totalPages; i++) {
            const btn = document.createElement('button');
            btn.className = `sheet-page-btn ${i === state.currentPage ? 'active' : ''}`;
            btn.textContent = i;
            state.pagesGrid.appendChild(btn);
        }
        
        openSheet(state.pageSheet);
    }

    function openSearchSheet() {
        openSheet(state.searchSheet);
    }

    function openSheet(sheet) {
        closeAllSheets();
        sheet.classList.add('active');
        state.fadeBg.classList.add('active');
        document.body.style.touchAction = 'none';
    }

    function closeAllSheets() {
        document.body.style.touchAction = '';
        state.pageSheet.classList.remove('active');
        state.searchSheet.classList.remove('active');
        state.typeSheet.classList.remove('active');
        state.raritySheet.classList.remove('active');
        state.fadeBg.classList.remove('active');
    }

    function openModal(box, item) {
        if (state.activeClone || state.isModalAnimating) return;
        
        state.isModalAnimating = true;
        document.body.style.overflow = 'hidden';
        
        const rect = box.getBoundingClientRect();
        
        state.modalContainer = document.createElement('div');
        state.modalContainer.className = 'modal-container';
        state.modalContainer.style.pointerEvents = 'none';
        document.body.appendChild(state.modalContainer);
        
        const modal = document.createElement('div');
        modal.classList.add('modal');
        modal.style.left = rect.left + 'px';
        modal.style.top = rect.top + 'px';
        modal.style.width = rect.width + 'px';
        modal.style.height = rect.height + 'px';
        modal.style.pointerEvents = 'none';
        
        const modalIcon = createImageElement(item.icon, 'modal-icon', item.name || item.icon);
        modalIcon.style.pointerEvents = 'none';
        modal.appendChild(modalIcon);
        
        state.modalContainer.appendChild(modal);
        
        state.activeClone = modal;
        state.originalBox = box;
        
        setTimeout(() => {
            state.fadeBg.classList.add('active');
            state.modalContainer.classList.add('active');
            
            modal.style.left = '50%';
            modal.style.top = 'calc(50% - 100px)';
            modal.style.transform = 'translate(-50%, -50%) scale(1.8)';
            modal.style.width = '200px';
            modal.style.height = '200px';
            
            setTimeout(() => {
                state.detailsCard = createDetailsCard(item);
                state.modalContainer.appendChild(state.detailsCard);
                
                const modalRect = modal.getBoundingClientRect();
                
                state.detailsCard.style.left = '50%';
                state.detailsCard.style.top = (modalRect.bottom + 20) + 'px';
                state.detailsCard.style.width = modalRect.width + 'px';
                state.detailsCard.style.transform = 'translateX(-50%)';
                
                setTimeout(() => {
                    state.detailsCard.classList.add('active');
                    state.isModalAnimating = false;
                }, 50);
            }, 400);
        }, 50);
    }

    function createDetailsCard(item) {
        const detailsCard = document.createElement('div');
        detailsCard.className = 'details-card';
        
        if (state.currentMode === 'icons') {
            const iconNameTitle = document.createElement('div');
            iconNameTitle.className = 'details-title ibm-plex-mono-bold';
            iconNameTitle.textContent = extractIconName(item.icon);
            detailsCard.appendChild(iconNameTitle);
        } else {
            if (item.name) {
                const title = document.createElement('div');
                title.className = 'details-title ibm-plex-mono-bold';
                let titleText = item.name;
                if (item.description) {
                    titleText += ` - ${item.description}`;
                }
                title.textContent = titleText;
                detailsCard.appendChild(title);
            }
            
            const propertiesContainer = document.createElement('div');
            propertiesContainer.className = 'details-properties';
            
            if (item.itemID) {
                const idProperty = document.createElement('div');
                idProperty.className = 'details-property';
                
                const idLabel = document.createElement('span');
                idLabel.className = 'details-property-label ibm-plex-mono-bold';
                idLabel.textContent = 'Item ID: ';
                
                const idValue = document.createElement('span');
                idValue.className = 'details-property-value ibm-plex-mono-regular';
                idValue.textContent = item.itemID;
                
                idProperty.appendChild(idLabel);
                idProperty.appendChild(idValue);
                propertiesContainer.appendChild(idProperty);
            }
            
            if (item.icon) {
                const iconProperty = document.createElement('div');
                iconProperty.className = 'details-property';
                
                const iconLabel = document.createElement('span');
                iconLabel.className = 'details-property-label ibm-plex-mono-bold';
                iconLabel.textContent = 'Icon: ';
                
                const iconValue = document.createElement('span');
                iconValue.className = 'details-property-value ibm-plex-mono-regular';
                iconValue.textContent = item.icon;
                
                iconProperty.appendChild(iconLabel);
                iconProperty.appendChild(iconValue);
                propertiesContainer.appendChild(iconProperty);
            }
            
            detailsCard.appendChild(propertiesContainer);
        }
        
        return detailsCard;
    }

    function closeModal() {
        if (!state.activeClone || !state.originalBox || state.isModalAnimating) return;
        
        state.isModalAnimating = true;
        document.body.style.overflow = '';
        
        if (state.detailsCard) {
            state.detailsCard.style.transform = 'translateX(-50%) translateY(20px)';
            state.detailsCard.style.opacity = '0';
        }
        
        state.fadeBg.classList.remove('active');
        state.modalContainer.classList.remove('active');
        
        const rect = state.originalBox.getBoundingClientRect();
        
        state.activeClone.style.left = rect.left + 'px';
        state.activeClone.style.top = rect.top + 'px';
        state.activeClone.style.width = rect.width + 'px';
        state.activeClone.style.height = rect.height + 'px';
        state.activeClone.style.transform = 'translate(0,0) scale(1)';
        
        setTimeout(() => {
            if (state.modalContainer && state.modalContainer.parentNode) {
                state.modalContainer.remove();
            }
            state.activeClone = null;
            state.modalContainer = null;
            state.detailsCard = null;
            state.isModalAnimating = false;
        }, 400);
    }

    return {
        init: init
    };
})();

document.addEventListener('DOMContentLoaded', function() {
    Logic.init();
});
    </script>
  </body>
</html>
